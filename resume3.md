# Question Bot 專案履歷

## 專案概述
Question Bot 是一個 Telegram 機器人應用程式，旨在促進公司與客戶之間的溝通。該機器人主要用於將客戶問題（Excel 格式）轉發到適當的 Telegram 群組，並同時向多個客戶發送群組訊息。

## 目的與功能
此機器人的主要目的是：
1. 根據檔案名稱模式將客戶問題（Excel 檔案）轉發到特定客戶 Telegram 群組
2. 同時向多個客戶群組發送群組訊息
3. 追蹤訊息傳遞成功/失敗
4. 提供用戶友好的 GUI 界面進行機器人操作

## 使用技術
- **Python 3.10**：核心程式語言
- **python-telegram-bot (v21.0.1)**：用於 Telegram API 整合
- **pandas (v1.5.3)**：用於數據操作和 Excel 檔案處理
- **openpyxl (v3.0.10)**：用於 Excel 檔案操作
- **tkinter**：用於 GUI 實現
- **asyncio**：用於非同步操作
- **threading**：用於多線程支持

## 架構與實現
該專案圍繞以下組件構建：

### 1. QuestionBot 類
核心類別，處理所有機器人功能：
- 使用 Telegram API 令牌初始化機器人
- 設置數據存儲的文件路徑
- 管理命令處理程序
- 處理文檔和訊息
- 處理群組訊息發送

### 2. GUI 界面
一個簡單的基於 tkinter 的界面，可以：
- 允許設置要處理的問題數量
- 顯示控制台輸出
- 提供啟動機器人的按鈕

### 3. 數據管理
- 使用 Excel 檔案存儲客戶群組 ID
- 讀取和寫入 Excel 檔案以進行群組訊息發送
- 追蹤訊息傳遞狀態

## 功能特點
1. **文檔轉發**：
   - 根據檔案名稱模式將 Excel 文檔轉發到特定客戶群組
   - 追蹤轉發成功/失敗

2. **群組訊息發送**：
   - 向多個客戶群組發送訊息
   - 支持同一客戶的訊息合併
   - 允許添加客戶名稱作為標題
   - 支持文件附件

3. **命令處理**：
   - `/check`：檢查當前問題計數設置
   - `/ID`：獲取聊天 ID
   - `/reset`：重置問題計數並刷新群組 ID 數據
   - `/gms`：使用各種參數發送群組訊息
   - `/help`：顯示幫助信息

4. **錯誤處理和報告**：
   - 追蹤並報告失敗的訊息傳遞
   - 提供詳細的錯誤訊息

5. **速率限制**：
   - 在訊息之間實施暫停以避免 Telegram API 速率限制

## 技術細節
- 使用非同步程式設計進行高效訊息處理
- 實現多線程以保持 GUI 響應
- 將控制台輸出重定向到 GUI 文本區域
- 從外部 Excel 數據庫讀取客戶群組 ID
- 支持各種訊息格式選項

## 部署
該應用程式作為帶有 GUI 界面的桌面應用程式運行。它需要：
- Python 3.10 環境
- 訪問指定的網絡路徑以獲取數據文件
- Telegram 機器人令牌用於 API 訪問

## 安全考慮
- 機器人令牌硬編碼在源代碼中
- 機器人根據允許列表檢查用戶 ID 以進行命令訪問
- 文件路徑指向需要適當訪問權限的網絡位置