
# 憑證資料整理(certificate_info_organize)

依據客戶提供的憑證資料，整理出所需資訊，與客戶提供自行填寫表去做檢驗
可大幅省去人工一個一個憑證開啟核對的時間，且達成檢查步驟的一致性

## 功能特點

### 1. 自動化對帳流程
- 自動從指定路徑獲取後台數據和憑證文件
- 支援多種文件格式：Excel、CSV、XML
- 自動識別並處理不同系統的憑證格式

### 2. 數據比對與驗證
- 比對客戶提供的紀錄表與憑證上記錄的差異
- 計算並顯示差額
- 自動標記檢查結果（成功/失敗）

### 3. 多系統支援
- 支援多種不同的客戶後台系統，並且提供了擴充性，後續有新的系統，可新增
- 自動適配不同系統的數據格式和欄位名稱

### 4. 結果匯總與展示
- 生成匯總報表
- 應用專業的Excel樣式，提高可讀性
- 支援超連結直接訪問原始文件

### 5. 圖形化界面
- 提供簡潔的GUI操作界面
- 支援從雲端或本地桌面獲取數據
- 實時顯示處理日誌和錯誤信息

### 基本操作
`
1. 啟動exe應用程序
2. 在輸入框中輸入日期範圍（格式：YYMMDD-YYMMDD）或是單日（格式：YYMMDD)
3. 選擇操作模式：
   - **取得總表**：從雲端獲取數據並生成總表
   - **更新**：從雲端更新現有總表中的檢查標示為False的項目
   - **更新失敗**：從雲端處理之前失敗的文件
   - **取得總表(桌面)**：從桌面獲取數據並生成總表
   - **更新(桌面)**：從桌面更新現有總表中的檢查標示為False的項目
   - **更新失敗(桌面)**：從桌面處理之前失敗的文件


### 數據來源選擇

- **雲端模式**：從雲端路徑獲取數據（默認模式）
- **桌面模式**：從本地桌面路徑獲取數據（適用於無法訪問雲端時）

## 文件結構

- `certificate_info_organize.py`：主程序文件，包含GUI和核心功能
- `style.py`：Excel樣式處理模塊，負責美化輸出報表

## 主要類別說明

### 數據處理類
- `SummeryTable`：處理總表生成和更新的核心類
- `SummeryTableByDeskTop`：桌面模式的總表處理類
- `ClientMould`：客戶模板處理類

### 憑證處理類
- `CertificateForSystem1`、`CertificateForSystem2`等：不同系統的憑證處理類
- 每個類負責解析特定系統的憑證格式並提取關鍵數據

### 界面類
- `Button`：處理GUI按鈕事件
- `RedirectText`：將控制台輸出重定向到GUI文本區域(後續因為改應用多進程加快處理速度，多進程溝通問題導致暫時無法輸出控制台資訊)

## 注意事項

- 確保模板文件格式正確，否則可能導致處理失敗
- 處理大量數據時可能需要較長時間，請耐心等待
- 總表生成後會自動應用樣式
- 如遇到處理失敗的情況，可使用"更新失敗"功能重試


## 授權

此工具僅供內部使用，未經授權請勿外傳或商業使用。